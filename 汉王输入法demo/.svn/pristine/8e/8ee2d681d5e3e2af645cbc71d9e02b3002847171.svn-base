//
//  GZPublicMethod.m
//  HanvonInput
//
//  Created by hanvon on 2017/11/8.
//  Copyright © 2017年 hanvon. All rights reserved.
//

#import "GZPublicMethod.h"

@implementation GZPublicMethod

+ (GZPublicMethod *)sharedPublicMethod{
    static GZPublicMethod *_sharedManager = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        _sharedManager = [[GZPublicMethod alloc] init];
    });

    return _sharedManager;
}



//计算字符串宽高
- (CGSize)measureSinglelineStringWithString:(NSString*)str andFont:(UIFont*)wordFont{

    if (str == nil)
        return CGSizeMake(0,0);

    CGSize measureSize = [str boundingRectWithSize:CGSizeMake(0, 0)
                                           options:NSStringDrawingUsesFontLeading
                                        attributes:[NSDictionary dictionaryWithObjectsAndKeys:wordFont, NSFontAttributeName, nil]
                                           context:nil].size;

    //    if([[UIDevice currentDevice].systemVersion floatValue] < 7.0){
    //        measureSize = [str sizeWithFont:wordFont constrainedToSize:CGSizeMake(MAXFLOAT, MAXFLOAT) lineBreakMode:NSLineBreakByWordWrapping];
    //    }else{
    //        measureSize = [str boundingRectWithSize:CGSizeMake(0, 0) options:NSStringDrawingUsesFontLeading attributes:[NSDictionary dictionaryWithObjectsAndKeys:wordFont, NSFontAttributeName, nil] context:nil].size;
    //    }
    return measureSize;
}

//计算带有字间距、行间距的字符串尺寸
- (CGSize)getStringSize:(NSString*)str
               withFont:(UIFont*)font
              wordSpace:(NSNumber*)wordSpace //字间距
              lineSpace:(CGFloat)lineSpace { //行间距

    if (str == nil)
        return CGSizeMake(0,0);

    NSMutableParagraphStyle *paraStyle = [[NSMutableParagraphStyle alloc] init];
    paraStyle.lineBreakMode = NSLineBreakByCharWrapping;
    //paraStyle.alignment = NSTextAlignmentLeft;
    paraStyle.lineSpacing = lineSpace;
    paraStyle.hyphenationFactor = 1.0;
    paraStyle.firstLineHeadIndent = 0.0;
    paraStyle.paragraphSpacingBefore = 0.0;
    paraStyle.headIndent = 0;
    paraStyle.tailIndent = 0;
    NSDictionary *dic = @{
                          NSFontAttributeName:font,
                          NSParagraphStyleAttributeName:paraStyle,
                          NSKernAttributeName:wordSpace
                          };

    CGSize size = [str boundingRectWithSize:CGSizeMake(0, 0)
                                    options:NSStringDrawingUsesLineFragmentOrigin
                                 attributes:dic
                                    context:nil].size;
    return size;
}


//计算字符串的宽度
- (float)widthForString:(NSString *)value
                   font:(UIFont *)font
                //color:(UIColor *)color
              andHeight:(float)height{
    CGRect sizeToFit = [value boundingRectWithSize:CGSizeMake(CGFLOAT_MAX, height)
                                           options:NSStringDrawingUsesLineFragmentOrigin
                                        attributes:@{
                                                     //NSForegroundColorAttributeName:color,
                                                     NSFontAttributeName:font
                                                     }
                                           context:nil];

    return sizeToFit.size.width;
}
//计算字符串的高度
- (float)heightForString:(NSString *)value
                    font:(UIFont *)font
                 //color:(UIColor *)color
                andWidth:(float)width{
    CGRect sizeToFit = [value boundingRectWithSize:CGSizeMake(width, CGFLOAT_MAX)
                                           options:NSStringDrawingUsesLineFragmentOrigin
                                        attributes:@{
                                                     //NSForegroundColorAttributeName:color,
                                                     NSFontAttributeName:font
                                                     }
                                           context:nil];

    return sizeToFit.size.height;
}


//获取像素的宽高
- (CGFloat)getPXWithPt:(CGFloat)pt {
    double scale;
    if (IS_IPHONE_6P || IS_IPHONE_X){
        scale = 1/2.0;
    }else if (IS_IPHONE_6){
        scale = 2.0;
    }else{
        scale = 1.0;
    }
    NSLog(@"=======%f",scale);
    return pt * scale;
}



@end
